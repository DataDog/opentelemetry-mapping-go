# Defines the file format. MUST be set to 1.1.0.
file_format: 1.1.0

# The Schema URL that this file is published at. The version number in the URL
# MUST match the highest version number in the "versions" section below.
# Note: the schema version number in the URL is not related in any way to
# the file_format setting above.
schema_url: /schemas/1.1.0

# Definitions for each schema version in this family. This is similar to how database migrations would work.
migrations:
  # Definitions for version 1.
  # Definitions that apply to Span data type. Transformations are applied in order.
  - spans:
      changes:
        # these changes apply to all spans.

        # this type of transformation allows to change the value of the tag or set it in case it wasn't present in the span.
        - change_attribute_values:
            attribute_map:
              # Given span.kind could be client or server for http.request spans, this transformation will result in
              # http.client.request or http.server.request.
              name: 'http.{{ getTag "span.kind" }}.request'

            # apply_to_spans contains a list of go text/template boolean expressions which will be connected with the AND operator logic.
            apply_to_spans:
              - hasTag "span.kind"
              - hasTag "http.method"
              - eqTagAny "span.kind" "client" "server"
        
        - change_attribute_values:
            attribute_map:
              name: '{{ getTag "rpc.system" }}.{{ getTag "span.kind" }}.request'

            apply_to_spans:
              - hasTag "span.kind"
              - hasTag "rpc.system"
              - eqTagAny "span.kind" "client" "server"